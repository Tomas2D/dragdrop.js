"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Dragdrop=function(){function Dragdrop(){_classCallCheck(this,Dragdrop);this.elements=this.getElements();for(var _len=arguments.length,params=Array(_len),_key=0;_key<_len;_key++){params[_key]=arguments[_key]}this.treatParams(params);this.targets=document.querySelectorAll(this.elements.targets);this.elements=document.querySelectorAll(this.elements.element);this.orders=[];this.onInit()}_createClass(Dragdrop,[{key:"getElements",value:function getElements(){return{element:".dragdrop",targets:".dragdrop-target"}}},{key:"getOrders",value:function getOrders(){var _this=this;this.orders=[];[].forEach.call(this.targets,function(target){if(target.childNodes.length){target.childNodes.forEach(function(child){if(child.tagName){var elementId=child.getAttribute("data-id")||0;var order=parseInt(target.getAttribute("dragdrop-order"));_this.orders.push({elementId:elementId,order:order})}})}})}},{key:"mergeElements",value:function mergeElements(elements){Object.assign(this.elements,elements)}},{key:"treatParams",value:function treatParams(params){if(params.length==1){if(_typeof(params[0])==="object"){this.mergeElements(params[0])}else if(typeof params[0]==="function"){params[0](document,this)}}else if(params.length>1&&_typeof(params[0])=="object"){this.mergeElements(params[0]);params[1](document,this)}}},{key:"changePosition",value:function changePosition(event,childs){if(childs.length){var parentId=event.dataTransfer.getData("parent");var $parent=document.getElementById(parentId);childs.forEach(function(child){if(child.tagName){$parent.appendChild(child)}})}}},{key:"dispatchEventsTarget",value:function dispatchEventsTarget(){var _this2=this;var index=1;[].forEach.call(this.targets,function(target){target.setAttribute("dragdrop","target");target.setAttribute("dragdrop-order",index);target.id="dragdrop-target-"+index;_this2.drop(target);_this2.dragover(target);_this2.dragleave(target);_this2.dragend(target);index++})}},{key:"dispatchEventsElements",value:function dispatchEventsElements(){var _this3=this;var index=1;[].forEach.call(this.elements,function(element){element.setAttribute("dragdrop","element");element.setAttribute("draggable","true");element.id="dragdrop-"+index;_this3.dragstart(element);index++})}},{key:"dragstart",value:function dragstart(element){element.addEventListener("dragstart",function(event){var parent=this.parentNode;event.dataTransfer.setData("parent",parent.id);event.dataTransfer.setData("text/plain",this.id)})}},{key:"drop",value:function drop(target){var self=this;target.addEventListener("drop",function(event){var id=event.dataTransfer.getData("text");var el=document.getElementById(id);self.changePosition(event,this.childNodes);this.appendChild(el);if(!this.classList.contains("over")){this.classList.add("over")}self.getOrders()})}},{key:"dragover",value:function dragover(target){target.addEventListener("dragover",function(event){event.preventDefault();if(!this.classList.contains("over")){this.classList.add("over")}})}},{key:"dragleave",value:function dragleave(target){target.addEventListener("dragleave",function(event){if(this.classList.contains("over")){this.classList.remove("over")}})}},{key:"dragend",value:function dragend(target){target.addEventListener("dragend",function(event){if(this.classList.contains("over")){this.classList.remove("over")}})}},{key:"onInit",value:function onInit(){this.dispatchEventsTarget();this.dispatchEventsElements();this.getOrders()}}]);return Dragdrop}();